{% extends "base.jinja" %}
{% from "common.jinja" import item_component, list_page, paginator, breadcrumb, subnav %}

{% set FULLCALENDAR_VERSION="3.4.0" %}

{% block extra_css %}
    <link rel='stylesheet' href="//cdnjs.cloudflare.com/ajax/libs/fullcalendar/{{FULLCALENDAR_VERSION}}/fullcalendar.min.css">
{% endblock %}

{% block title %}Community Events{% endblock %}

{% block introduction %}<h1>Community Events</h1>{% endblock %}


{% block content %}
    {{ breadcrumb([{'text': 'Community Events' }]) }}
    {# FIXME: make a tab navigation to switch between list view and calendar view #}
    {{ subnav([ 
    {'text': 'Calendar View', 'url': url('home:events-calendar'), 'active': True},
    {'text': 'List View', 'url': url('home:event-list'), },
    ])
    }}
    <div id="calendar"></div>
{% endblock %}

{% block js %}
    {{ super() }}
    {# TODO: Should use npm to store the calendar dependencies #}
    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fullcalendar/{{FULLCALENDAR_VERSION}}/fullcalendar.min.js"></script>
    <script>
        {# TODO: display description in tooltip as well #}
        $(document).ready(function () {
            $('#calendar').fullCalendar({
                events: {
                    'url': '/events/calendar/',
                    'allDayDefault': true
                },
                eventRender: function(event, element) {
                    let eventElement = element[0];
                    eventElement.setAttribute('data-toggle', 'tooltip');
                    eventElement.setAttribute('title', event.title);
                }
            });
        });
    </script>
{% endblock %}
